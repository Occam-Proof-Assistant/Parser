'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Graph = require('../graph'),
    RightRecursiveProduction = require('../common/production/rightRecursive'),
    PossiblyCyclicProduction = require('../common/production/possiblyCyclic'),
    NonLeftRecursiveProduction = require('../common/production/nonLeftRecursive'),
    NonImplicitlyLeftRecursiveProduction = require('../common/production/nonImplicitlyLeftRecursive');

var parserUtil = function () {
  function parserUtil() {
    _classCallCheck(this, parserUtil);
  }

  _createClass(parserUtil, null, [{
    key: 'tokensFromLines',
    value: function tokensFromLines(lines) {
      var tokens = lines.reduce(function (tokens, line) {
        var lineTokens = line.getTokens();

        tokens = tokens.concat(lineTokens);

        return tokens;
      }, []);

      return tokens;
    }
  }, {
    key: 'eliminateCycles',
    value: function eliminateCycles(productions) {
      var possiblyCyclicProductions = possiblyCyclicProductionsFromProductions(productions),
          graph = graphFromPossiblyCyclicProductions(possiblyCyclicProductions),
          stronglyConnectedComponents = graph.getStronglyConnectedComponents();

      debugger;

      return productions;
    }
  }, {
    key: 'eliminateLeftRecursion',
    value: function eliminateLeftRecursion(productions) {
      var nonLeftRecursiveProductions = [],
          rightRecursiveProductions = [];

      productions.forEach(function (production, index) {
        var begin = 0,
            end = index,
            ///
        previousNonLeftRecursiveProductions = nonLeftRecursiveProductions.slice(begin, end),
            previousProductions = previousNonLeftRecursiveProductions,
            ///
        productionImplicitlyLeftRecursive = production.isImplicitlyLeftRecursive(previousProductions);

        if (productionImplicitlyLeftRecursive) {
          var nonImplicitlyLeftRecursiveProduction = NonImplicitlyLeftRecursiveProduction.fromProductionAndPreviousProductions(production, previousProductions);

          production = nonImplicitlyLeftRecursiveProduction; ///
        }

        var productionLeftRecursive = production.isLeftRecursive();

        if (productionLeftRecursive) {
          var nonLeftRecursiveProduction = NonLeftRecursiveProduction.fromProduction(production),
              rightRecursiveProduction = RightRecursiveProduction.fromProduction(production);

          nonLeftRecursiveProductions.push(nonLeftRecursiveProduction);

          rightRecursiveProductions.push(rightRecursiveProduction);
        } else {
          var _nonLeftRecursiveProduction = production; ///

          nonLeftRecursiveProductions.push(_nonLeftRecursiveProduction);
        }
      });

      productions = [].concat(nonLeftRecursiveProductions).concat(rightRecursiveProductions);

      return productions;
    }
  }]);

  return parserUtil;
}();

module.exports = parserUtil;

function possiblyCyclicProductionsFromProductions(productions) {
  var possiblyCyclicProductions = productions.reduce(function (possiblyCyclicProductions, production) {
    var possiblyCyclicProduction = PossiblyCyclicProduction.fromProduction(production);

    if (possiblyCyclicProduction !== null) {
      possiblyCyclicProductions.push(possiblyCyclicProduction);
    }

    return possiblyCyclicProductions;
  }, []);

  return possiblyCyclicProductions;
}

function graphFromPossiblyCyclicProductions(possiblyCyclicProductions) {
  var graph = new Graph();

  possiblyCyclicProductions.forEach(function (possiblyCyclicProduction) {
    var possiblyCyclicProductionName = possiblyCyclicProduction.getName(),
        possiblyCyclicProductionRulesProductionNames = possiblyCyclicProduction.getRulesProductionNames(),
        vertexName = possiblyCyclicProductionName,
        ///
    descendantVertexNames = possiblyCyclicProductionRulesProductionNames; ///

    graph.addVertex(vertexName, descendantVertexNames);
  });

  return graph;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi91dGlsL3BhcnNlci5qcyJdLCJuYW1lcyI6WyJHcmFwaCIsInJlcXVpcmUiLCJSaWdodFJlY3Vyc2l2ZVByb2R1Y3Rpb24iLCJQb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb24iLCJOb25MZWZ0UmVjdXJzaXZlUHJvZHVjdGlvbiIsIk5vbkltcGxpY2l0bHlMZWZ0UmVjdXJzaXZlUHJvZHVjdGlvbiIsInBhcnNlclV0aWwiLCJsaW5lcyIsInRva2VucyIsInJlZHVjZSIsImxpbmUiLCJsaW5lVG9rZW5zIiwiZ2V0VG9rZW5zIiwiY29uY2F0IiwicHJvZHVjdGlvbnMiLCJwb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb25zIiwicG9zc2libHlDeWNsaWNQcm9kdWN0aW9uc0Zyb21Qcm9kdWN0aW9ucyIsImdyYXBoIiwiZ3JhcGhGcm9tUG9zc2libHlDeWNsaWNQcm9kdWN0aW9ucyIsInN0cm9uZ2x5Q29ubmVjdGVkQ29tcG9uZW50cyIsImdldFN0cm9uZ2x5Q29ubmVjdGVkQ29tcG9uZW50cyIsIm5vbkxlZnRSZWN1cnNpdmVQcm9kdWN0aW9ucyIsInJpZ2h0UmVjdXJzaXZlUHJvZHVjdGlvbnMiLCJmb3JFYWNoIiwicHJvZHVjdGlvbiIsImluZGV4IiwiYmVnaW4iLCJlbmQiLCJwcmV2aW91c05vbkxlZnRSZWN1cnNpdmVQcm9kdWN0aW9ucyIsInNsaWNlIiwicHJldmlvdXNQcm9kdWN0aW9ucyIsInByb2R1Y3Rpb25JbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZSIsImlzSW1wbGljaXRseUxlZnRSZWN1cnNpdmUiLCJub25JbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZVByb2R1Y3Rpb24iLCJmcm9tUHJvZHVjdGlvbkFuZFByZXZpb3VzUHJvZHVjdGlvbnMiLCJwcm9kdWN0aW9uTGVmdFJlY3Vyc2l2ZSIsImlzTGVmdFJlY3Vyc2l2ZSIsIm5vbkxlZnRSZWN1cnNpdmVQcm9kdWN0aW9uIiwiZnJvbVByb2R1Y3Rpb24iLCJyaWdodFJlY3Vyc2l2ZVByb2R1Y3Rpb24iLCJwdXNoIiwibW9kdWxlIiwiZXhwb3J0cyIsInBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvbiIsInBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvbk5hbWUiLCJnZXROYW1lIiwicG9zc2libHlDeWNsaWNQcm9kdWN0aW9uUnVsZXNQcm9kdWN0aW9uTmFtZXMiLCJnZXRSdWxlc1Byb2R1Y3Rpb25OYW1lcyIsInZlcnRleE5hbWUiLCJkZXNjZW5kYW50VmVydGV4TmFtZXMiLCJhZGRWZXJ0ZXgiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7QUFFQSxJQUFNQSxRQUFRQyxRQUFRLFVBQVIsQ0FBZDtBQUFBLElBQ01DLDJCQUEyQkQsUUFBUSxxQ0FBUixDQURqQztBQUFBLElBRU1FLDJCQUEyQkYsUUFBUSxxQ0FBUixDQUZqQztBQUFBLElBR01HLDZCQUE2QkgsUUFBUSx1Q0FBUixDQUhuQztBQUFBLElBSU1JLHVDQUF1Q0osUUFBUSxpREFBUixDQUo3Qzs7SUFNTUssVTs7Ozs7OztvQ0FDbUJDLEssRUFBTztBQUM1QixVQUFNQyxTQUFTRCxNQUFNRSxNQUFOLENBQWEsVUFBU0QsTUFBVCxFQUFpQkUsSUFBakIsRUFBdUI7QUFDakQsWUFBTUMsYUFBYUQsS0FBS0UsU0FBTCxFQUFuQjs7QUFFQUosaUJBQVNBLE9BQU9LLE1BQVAsQ0FBY0YsVUFBZCxDQUFUOztBQUVBLGVBQU9ILE1BQVA7QUFDRCxPQU5jLEVBTVosRUFOWSxDQUFmOztBQVFBLGFBQU9BLE1BQVA7QUFDRDs7O29DQUVzQk0sVyxFQUFhO0FBQ2xDLFVBQU1DLDRCQUE0QkMseUNBQXlDRixXQUF6QyxDQUFsQztBQUFBLFVBQ01HLFFBQVFDLG1DQUFtQ0gseUJBQW5DLENBRGQ7QUFBQSxVQUVNSSw4QkFBOEJGLE1BQU1HLDhCQUFOLEVBRnBDOztBQUlBOztBQUVBLGFBQU9OLFdBQVA7QUFDRDs7OzJDQUU2QkEsVyxFQUFhO0FBQ3pDLFVBQU1PLDhCQUE4QixFQUFwQztBQUFBLFVBQ01DLDRCQUE0QixFQURsQzs7QUFHQVIsa0JBQVlTLE9BQVosQ0FBb0IsVUFBU0MsVUFBVCxFQUFxQkMsS0FBckIsRUFBNEI7QUFDOUMsWUFBTUMsUUFBUSxDQUFkO0FBQUEsWUFDTUMsTUFBTUYsS0FEWjtBQUFBLFlBQ29CO0FBQ2RHLDhDQUFzQ1AsNEJBQTRCUSxLQUE1QixDQUFrQ0gsS0FBbEMsRUFBeUNDLEdBQXpDLENBRjVDO0FBQUEsWUFHTUcsc0JBQXNCRixtQ0FINUI7QUFBQSxZQUdrRTtBQUM1REcsNENBQW9DUCxXQUFXUSx5QkFBWCxDQUFxQ0YsbUJBQXJDLENBSjFDOztBQU1BLFlBQUlDLGlDQUFKLEVBQXVDO0FBQ3JDLGNBQU1FLHVDQUF1QzVCLHFDQUFxQzZCLG9DQUFyQyxDQUEwRVYsVUFBMUUsRUFBc0ZNLG1CQUF0RixDQUE3Qzs7QUFFQU4sdUJBQWFTLG9DQUFiLENBSHFDLENBR2U7QUFDckQ7O0FBRUQsWUFBTUUsMEJBQTBCWCxXQUFXWSxlQUFYLEVBQWhDOztBQUVBLFlBQUlELHVCQUFKLEVBQTZCO0FBQzNCLGNBQU1FLDZCQUE2QmpDLDJCQUEyQmtDLGNBQTNCLENBQTBDZCxVQUExQyxDQUFuQztBQUFBLGNBQ01lLDJCQUEyQnJDLHlCQUF5Qm9DLGNBQXpCLENBQXdDZCxVQUF4QyxDQURqQzs7QUFHQUgsc0NBQTRCbUIsSUFBNUIsQ0FBaUNILDBCQUFqQzs7QUFFQWYsb0NBQTBCa0IsSUFBMUIsQ0FBK0JELHdCQUEvQjtBQUNELFNBUEQsTUFPTztBQUNMLGNBQU1GLDhCQUE2QmIsVUFBbkMsQ0FESyxDQUMyQzs7QUFFaERILHNDQUE0Qm1CLElBQTVCLENBQWlDSCwyQkFBakM7QUFDRDtBQUNGLE9BM0JEOztBQTZCQXZCLG9CQUFjLEdBQUdELE1BQUgsQ0FBVVEsMkJBQVYsRUFBdUNSLE1BQXZDLENBQThDUyx5QkFBOUMsQ0FBZDs7QUFFQSxhQUFPUixXQUFQO0FBQ0Q7Ozs7OztBQUdIMkIsT0FBT0MsT0FBUCxHQUFpQnBDLFVBQWpCOztBQUVBLFNBQVNVLHdDQUFULENBQWtERixXQUFsRCxFQUErRDtBQUM3RCxNQUFNQyw0QkFBNEJELFlBQVlMLE1BQVosQ0FBbUIsVUFBU00seUJBQVQsRUFBb0NTLFVBQXBDLEVBQWdEO0FBQ25HLFFBQU1tQiwyQkFBMkJ4Qyx5QkFBeUJtQyxjQUF6QixDQUF3Q2QsVUFBeEMsQ0FBakM7O0FBRUEsUUFBSW1CLDZCQUE2QixJQUFqQyxFQUF1QztBQUNyQzVCLGdDQUEwQnlCLElBQTFCLENBQStCRyx3QkFBL0I7QUFDRDs7QUFFRCxXQUFPNUIseUJBQVA7QUFDRCxHQVJpQyxFQVEvQixFQVIrQixDQUFsQzs7QUFVQSxTQUFPQSx5QkFBUDtBQUNEOztBQUVELFNBQVNHLGtDQUFULENBQTRDSCx5QkFBNUMsRUFBdUU7QUFDckUsTUFBTUUsUUFBUSxJQUFJakIsS0FBSixFQUFkOztBQUVBZSw0QkFBMEJRLE9BQTFCLENBQWtDLFVBQVNvQix3QkFBVCxFQUFtQztBQUNuRSxRQUFNQywrQkFBK0JELHlCQUF5QkUsT0FBekIsRUFBckM7QUFBQSxRQUNNQywrQ0FBK0NILHlCQUF5QkksdUJBQXpCLEVBRHJEO0FBQUEsUUFFTUMsYUFBYUosNEJBRm5CO0FBQUEsUUFFa0Q7QUFDNUNLLDRCQUF3QkgsNENBSDlCLENBRG1FLENBSVM7O0FBRTVFN0IsVUFBTWlDLFNBQU4sQ0FBZ0JGLFVBQWhCLEVBQTRCQyxxQkFBNUI7QUFDRCxHQVBEOztBQVNBLFNBQU9oQyxLQUFQO0FBQ0QiLCJmaWxlIjoicGFyc2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBHcmFwaCA9IHJlcXVpcmUoJy4uL2dyYXBoJyksXG4gICAgICBSaWdodFJlY3Vyc2l2ZVByb2R1Y3Rpb24gPSByZXF1aXJlKCcuLi9jb21tb24vcHJvZHVjdGlvbi9yaWdodFJlY3Vyc2l2ZScpLFxuICAgICAgUG9zc2libHlDeWNsaWNQcm9kdWN0aW9uID0gcmVxdWlyZSgnLi4vY29tbW9uL3Byb2R1Y3Rpb24vcG9zc2libHlDeWNsaWMnKSxcbiAgICAgIE5vbkxlZnRSZWN1cnNpdmVQcm9kdWN0aW9uID0gcmVxdWlyZSgnLi4vY29tbW9uL3Byb2R1Y3Rpb24vbm9uTGVmdFJlY3Vyc2l2ZScpLFxuICAgICAgTm9uSW1wbGljaXRseUxlZnRSZWN1cnNpdmVQcm9kdWN0aW9uID0gcmVxdWlyZSgnLi4vY29tbW9uL3Byb2R1Y3Rpb24vbm9uSW1wbGljaXRseUxlZnRSZWN1cnNpdmUnKTtcblxuY2xhc3MgcGFyc2VyVXRpbCB7XG4gIHN0YXRpYyB0b2tlbnNGcm9tTGluZXMobGluZXMpIHtcbiAgICBjb25zdCB0b2tlbnMgPSBsaW5lcy5yZWR1Y2UoZnVuY3Rpb24odG9rZW5zLCBsaW5lKSB7XG4gICAgICBjb25zdCBsaW5lVG9rZW5zID0gbGluZS5nZXRUb2tlbnMoKTtcblxuICAgICAgdG9rZW5zID0gdG9rZW5zLmNvbmNhdChsaW5lVG9rZW5zKTtcblxuICAgICAgcmV0dXJuIHRva2VucztcbiAgICB9LCBbXSk7XG5cbiAgICByZXR1cm4gdG9rZW5zO1xuICB9XG5cbiAgc3RhdGljIGVsaW1pbmF0ZUN5Y2xlcyhwcm9kdWN0aW9ucykge1xuICAgIGNvbnN0IHBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvbnMgPSBwb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb25zRnJvbVByb2R1Y3Rpb25zKHByb2R1Y3Rpb25zKSxcbiAgICAgICAgICBncmFwaCA9IGdyYXBoRnJvbVBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvbnMocG9zc2libHlDeWNsaWNQcm9kdWN0aW9ucyksXG4gICAgICAgICAgc3Ryb25nbHlDb25uZWN0ZWRDb21wb25lbnRzID0gZ3JhcGguZ2V0U3Ryb25nbHlDb25uZWN0ZWRDb21wb25lbnRzKCk7XG5cbiAgICBkZWJ1Z2dlclxuXG4gICAgcmV0dXJuIHByb2R1Y3Rpb25zO1xuICB9XG5cbiAgc3RhdGljIGVsaW1pbmF0ZUxlZnRSZWN1cnNpb24ocHJvZHVjdGlvbnMpIHtcbiAgICBjb25zdCBub25MZWZ0UmVjdXJzaXZlUHJvZHVjdGlvbnMgPSBbXSxcbiAgICAgICAgICByaWdodFJlY3Vyc2l2ZVByb2R1Y3Rpb25zID0gW107XG5cbiAgICBwcm9kdWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKHByb2R1Y3Rpb24sIGluZGV4KSB7XG4gICAgICBjb25zdCBiZWdpbiA9IDAsXG4gICAgICAgICAgICBlbmQgPSBpbmRleCwgIC8vL1xuICAgICAgICAgICAgcHJldmlvdXNOb25MZWZ0UmVjdXJzaXZlUHJvZHVjdGlvbnMgPSBub25MZWZ0UmVjdXJzaXZlUHJvZHVjdGlvbnMuc2xpY2UoYmVnaW4sIGVuZCksXG4gICAgICAgICAgICBwcmV2aW91c1Byb2R1Y3Rpb25zID0gcHJldmlvdXNOb25MZWZ0UmVjdXJzaXZlUHJvZHVjdGlvbnMsICAvLy9cbiAgICAgICAgICAgIHByb2R1Y3Rpb25JbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZSA9IHByb2R1Y3Rpb24uaXNJbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZShwcmV2aW91c1Byb2R1Y3Rpb25zKTtcblxuICAgICAgaWYgKHByb2R1Y3Rpb25JbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZSkge1xuICAgICAgICBjb25zdCBub25JbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZVByb2R1Y3Rpb24gPSBOb25JbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZVByb2R1Y3Rpb24uZnJvbVByb2R1Y3Rpb25BbmRQcmV2aW91c1Byb2R1Y3Rpb25zKHByb2R1Y3Rpb24sIHByZXZpb3VzUHJvZHVjdGlvbnMpO1xuXG4gICAgICAgIHByb2R1Y3Rpb24gPSBub25JbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZVByb2R1Y3Rpb247ICAvLy9cbiAgICAgIH1cblxuICAgICAgY29uc3QgcHJvZHVjdGlvbkxlZnRSZWN1cnNpdmUgPSBwcm9kdWN0aW9uLmlzTGVmdFJlY3Vyc2l2ZSgpO1xuXG4gICAgICBpZiAocHJvZHVjdGlvbkxlZnRSZWN1cnNpdmUpIHtcbiAgICAgICAgY29uc3Qgbm9uTGVmdFJlY3Vyc2l2ZVByb2R1Y3Rpb24gPSBOb25MZWZ0UmVjdXJzaXZlUHJvZHVjdGlvbi5mcm9tUHJvZHVjdGlvbihwcm9kdWN0aW9uKSxcbiAgICAgICAgICAgICAgcmlnaHRSZWN1cnNpdmVQcm9kdWN0aW9uID0gUmlnaHRSZWN1cnNpdmVQcm9kdWN0aW9uLmZyb21Qcm9kdWN0aW9uKHByb2R1Y3Rpb24pO1xuXG4gICAgICAgIG5vbkxlZnRSZWN1cnNpdmVQcm9kdWN0aW9ucy5wdXNoKG5vbkxlZnRSZWN1cnNpdmVQcm9kdWN0aW9uKTtcblxuICAgICAgICByaWdodFJlY3Vyc2l2ZVByb2R1Y3Rpb25zLnB1c2gocmlnaHRSZWN1cnNpdmVQcm9kdWN0aW9uKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IG5vbkxlZnRSZWN1cnNpdmVQcm9kdWN0aW9uID0gcHJvZHVjdGlvbjsgIC8vL1xuXG4gICAgICAgIG5vbkxlZnRSZWN1cnNpdmVQcm9kdWN0aW9ucy5wdXNoKG5vbkxlZnRSZWN1cnNpdmVQcm9kdWN0aW9uKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHByb2R1Y3Rpb25zID0gW10uY29uY2F0KG5vbkxlZnRSZWN1cnNpdmVQcm9kdWN0aW9ucykuY29uY2F0KHJpZ2h0UmVjdXJzaXZlUHJvZHVjdGlvbnMpO1xuXG4gICAgcmV0dXJuIHByb2R1Y3Rpb25zO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gcGFyc2VyVXRpbDtcblxuZnVuY3Rpb24gcG9zc2libHlDeWNsaWNQcm9kdWN0aW9uc0Zyb21Qcm9kdWN0aW9ucyhwcm9kdWN0aW9ucykge1xuICBjb25zdCBwb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb25zID0gcHJvZHVjdGlvbnMucmVkdWNlKGZ1bmN0aW9uKHBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvbnMsIHByb2R1Y3Rpb24pIHtcbiAgICBjb25zdCBwb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb24gPSBQb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb24uZnJvbVByb2R1Y3Rpb24ocHJvZHVjdGlvbik7XG5cbiAgICBpZiAocG9zc2libHlDeWNsaWNQcm9kdWN0aW9uICE9PSBudWxsKSB7XG4gICAgICBwb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb25zLnB1c2gocG9zc2libHlDeWNsaWNQcm9kdWN0aW9uKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcG9zc2libHlDeWNsaWNQcm9kdWN0aW9ucztcbiAgfSwgW10pO1xuXG4gIHJldHVybiBwb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb25zO1xufVxuXG5mdW5jdGlvbiBncmFwaEZyb21Qb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb25zKHBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvbnMpIHtcbiAgY29uc3QgZ3JhcGggPSBuZXcgR3JhcGgoKTtcblxuICBwb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb25zLmZvckVhY2goZnVuY3Rpb24ocG9zc2libHlDeWNsaWNQcm9kdWN0aW9uKSB7XG4gICAgY29uc3QgcG9zc2libHlDeWNsaWNQcm9kdWN0aW9uTmFtZSA9IHBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvbi5nZXROYW1lKCksXG4gICAgICAgICAgcG9zc2libHlDeWNsaWNQcm9kdWN0aW9uUnVsZXNQcm9kdWN0aW9uTmFtZXMgPSBwb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb24uZ2V0UnVsZXNQcm9kdWN0aW9uTmFtZXMoKSxcbiAgICAgICAgICB2ZXJ0ZXhOYW1lID0gcG9zc2libHlDeWNsaWNQcm9kdWN0aW9uTmFtZSwgIC8vL1xuICAgICAgICAgIGRlc2NlbmRhbnRWZXJ0ZXhOYW1lcyA9IHBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvblJ1bGVzUHJvZHVjdGlvbk5hbWVzOyAvLy9cblxuICAgIGdyYXBoLmFkZFZlcnRleCh2ZXJ0ZXhOYW1lLCBkZXNjZW5kYW50VmVydGV4TmFtZXMpO1xuICB9KTtcblxuICByZXR1cm4gZ3JhcGg7XG59XG4iXX0=