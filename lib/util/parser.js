'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Tuple = require('../common/tuple'),
    RightRecursiveProduction = require('../common/production/rightRecursive'),
    PossiblyCyclicProduction = require('../common/production/possiblyCyclic'),
    NonLeftRecursiveProduction = require('../common/production/nonLeftRecursive'),
    NonImplicitlyLeftRecursiveProduction = require('../common/production/nonImplicitlyLeftRecursive');

var parserUtil = function () {
  function parserUtil() {
    _classCallCheck(this, parserUtil);
  }

  _createClass(parserUtil, null, [{
    key: 'tokensFromLines',
    value: function tokensFromLines(lines) {
      var tokens = lines.reduce(function (tokens, line) {
        var lineTokens = line.getTokens();

        tokens = tokens.concat(lineTokens);

        return tokens;
      }, []);

      return tokens;
    }
  }, {
    key: 'eliminateCycles',
    value: function eliminateCycles(productions) {
      var possiblyCyclicProductions = possiblyCyclicProductionsFromProductions(productions),
          tuples = tuplesFromPossiblyCyclicProductions(possiblyCyclicProductions);

      debugger;

      return productions;
    }
  }, {
    key: 'eliminateLeftRecursion',
    value: function eliminateLeftRecursion(productions) {
      var nonLeftRecursiveProductions = [],
          rightRecursiveProductions = [];

      productions.forEach(function (production, index) {
        var begin = 0,
            end = index,
            ///
        previousNonLeftRecursiveProductions = nonLeftRecursiveProductions.slice(begin, end),
            previousProductions = previousNonLeftRecursiveProductions,
            ///
        productionImplicitlyLeftRecursive = production.isImplicitlyLeftRecursive(previousProductions);

        if (productionImplicitlyLeftRecursive) {
          var nonImplicitlyLeftRecursiveProduction = NonImplicitlyLeftRecursiveProduction.fromProductionAndPreviousProductions(production, previousProductions);

          production = nonImplicitlyLeftRecursiveProduction; ///
        }

        var productionLeftRecursive = production.isLeftRecursive();

        if (productionLeftRecursive) {
          var nonLeftRecursiveProduction = NonLeftRecursiveProduction.fromProduction(production),
              rightRecursiveProduction = RightRecursiveProduction.fromProduction(production);

          nonLeftRecursiveProductions.push(nonLeftRecursiveProduction);

          rightRecursiveProductions.push(rightRecursiveProduction);
        } else {
          var _nonLeftRecursiveProduction = production; ///

          nonLeftRecursiveProductions.push(_nonLeftRecursiveProduction);
        }
      });

      productions = [].concat(nonLeftRecursiveProductions).concat(rightRecursiveProductions);

      return productions;
    }
  }]);

  return parserUtil;
}();

module.exports = parserUtil;

function possiblyCyclicProductionsFromProductions(productions) {
  var possiblyCyclicProductions = productions.reduce(function (possiblyCyclicProductions, production) {
    var possiblyCyclicProduction = PossiblyCyclicProduction.fromProduction(production);

    if (possiblyCyclicProduction !== null) {
      possiblyCyclicProductions.push(possiblyCyclicProduction);
    }

    return possiblyCyclicProductions;
  }, []);

  return possiblyCyclicProductions;
}

function tuplesFromPossiblyCyclicProductions(possiblyCyclicProductions) {
  var tuples = possiblyCyclicProductions.reduce(function (tuples, possiblyCyclicProduction) {
    var possiblyCyclicProductionName = possiblyCyclicProduction.getName(),
        possiblyCyclicProductionRulesProductionNames = possiblyCyclicProduction.getRulesProductionNames();

    possiblyCyclicProductionRulesProductionNames.forEach(function (possiblyCyclicProductionRuleProductionName) {
      var firstElement = possiblyCyclicProductionName,
          ///
      secondElement = possiblyCyclicProductionRuleProductionName,
          ///
      tuple = new Tuple(firstElement, secondElement);

      tuples.push(tuple);
    });

    return tuples;
  }, []);

  return tuples;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi91dGlsL3BhcnNlci5qcyJdLCJuYW1lcyI6WyJUdXBsZSIsInJlcXVpcmUiLCJSaWdodFJlY3Vyc2l2ZVByb2R1Y3Rpb24iLCJQb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb24iLCJOb25MZWZ0UmVjdXJzaXZlUHJvZHVjdGlvbiIsIk5vbkltcGxpY2l0bHlMZWZ0UmVjdXJzaXZlUHJvZHVjdGlvbiIsInBhcnNlclV0aWwiLCJsaW5lcyIsInRva2VucyIsInJlZHVjZSIsImxpbmUiLCJsaW5lVG9rZW5zIiwiZ2V0VG9rZW5zIiwiY29uY2F0IiwicHJvZHVjdGlvbnMiLCJwb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb25zIiwicG9zc2libHlDeWNsaWNQcm9kdWN0aW9uc0Zyb21Qcm9kdWN0aW9ucyIsInR1cGxlcyIsInR1cGxlc0Zyb21Qb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb25zIiwibm9uTGVmdFJlY3Vyc2l2ZVByb2R1Y3Rpb25zIiwicmlnaHRSZWN1cnNpdmVQcm9kdWN0aW9ucyIsImZvckVhY2giLCJwcm9kdWN0aW9uIiwiaW5kZXgiLCJiZWdpbiIsImVuZCIsInByZXZpb3VzTm9uTGVmdFJlY3Vyc2l2ZVByb2R1Y3Rpb25zIiwic2xpY2UiLCJwcmV2aW91c1Byb2R1Y3Rpb25zIiwicHJvZHVjdGlvbkltcGxpY2l0bHlMZWZ0UmVjdXJzaXZlIiwiaXNJbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZSIsIm5vbkltcGxpY2l0bHlMZWZ0UmVjdXJzaXZlUHJvZHVjdGlvbiIsImZyb21Qcm9kdWN0aW9uQW5kUHJldmlvdXNQcm9kdWN0aW9ucyIsInByb2R1Y3Rpb25MZWZ0UmVjdXJzaXZlIiwiaXNMZWZ0UmVjdXJzaXZlIiwibm9uTGVmdFJlY3Vyc2l2ZVByb2R1Y3Rpb24iLCJmcm9tUHJvZHVjdGlvbiIsInJpZ2h0UmVjdXJzaXZlUHJvZHVjdGlvbiIsInB1c2giLCJtb2R1bGUiLCJleHBvcnRzIiwicG9zc2libHlDeWNsaWNQcm9kdWN0aW9uIiwicG9zc2libHlDeWNsaWNQcm9kdWN0aW9uTmFtZSIsImdldE5hbWUiLCJwb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb25SdWxlc1Byb2R1Y3Rpb25OYW1lcyIsImdldFJ1bGVzUHJvZHVjdGlvbk5hbWVzIiwicG9zc2libHlDeWNsaWNQcm9kdWN0aW9uUnVsZVByb2R1Y3Rpb25OYW1lIiwiZmlyc3RFbGVtZW50Iiwic2Vjb25kRWxlbWVudCIsInR1cGxlIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7O0FBRUEsSUFBTUEsUUFBUUMsUUFBUSxpQkFBUixDQUFkO0FBQUEsSUFDTUMsMkJBQTJCRCxRQUFRLHFDQUFSLENBRGpDO0FBQUEsSUFFTUUsMkJBQTJCRixRQUFRLHFDQUFSLENBRmpDO0FBQUEsSUFHTUcsNkJBQTZCSCxRQUFRLHVDQUFSLENBSG5DO0FBQUEsSUFJTUksdUNBQXVDSixRQUFRLGlEQUFSLENBSjdDOztJQU1NSyxVOzs7Ozs7O29DQUNtQkMsSyxFQUFPO0FBQzVCLFVBQU1DLFNBQVNELE1BQU1FLE1BQU4sQ0FBYSxVQUFTRCxNQUFULEVBQWlCRSxJQUFqQixFQUF1QjtBQUNqRCxZQUFNQyxhQUFhRCxLQUFLRSxTQUFMLEVBQW5COztBQUVBSixpQkFBU0EsT0FBT0ssTUFBUCxDQUFjRixVQUFkLENBQVQ7O0FBRUEsZUFBT0gsTUFBUDtBQUNELE9BTmMsRUFNWixFQU5ZLENBQWY7O0FBUUEsYUFBT0EsTUFBUDtBQUNEOzs7b0NBRXNCTSxXLEVBQWE7QUFDbEMsVUFBTUMsNEJBQTRCQyx5Q0FBeUNGLFdBQXpDLENBQWxDO0FBQUEsVUFDTUcsU0FBU0Msb0NBQW9DSCx5QkFBcEMsQ0FEZjs7QUFHQTs7QUFFQSxhQUFPRCxXQUFQO0FBQ0Q7OzsyQ0FFNkJBLFcsRUFBYTtBQUN6QyxVQUFNSyw4QkFBOEIsRUFBcEM7QUFBQSxVQUNNQyw0QkFBNEIsRUFEbEM7O0FBR0FOLGtCQUFZTyxPQUFaLENBQW9CLFVBQVNDLFVBQVQsRUFBcUJDLEtBQXJCLEVBQTRCO0FBQzlDLFlBQU1DLFFBQVEsQ0FBZDtBQUFBLFlBQ01DLE1BQU1GLEtBRFo7QUFBQSxZQUNvQjtBQUNkRyw4Q0FBc0NQLDRCQUE0QlEsS0FBNUIsQ0FBa0NILEtBQWxDLEVBQXlDQyxHQUF6QyxDQUY1QztBQUFBLFlBR01HLHNCQUFzQkYsbUNBSDVCO0FBQUEsWUFHa0U7QUFDNURHLDRDQUFvQ1AsV0FBV1EseUJBQVgsQ0FBcUNGLG1CQUFyQyxDQUoxQzs7QUFNQSxZQUFJQyxpQ0FBSixFQUF1QztBQUNyQyxjQUFNRSx1Q0FBdUMxQixxQ0FBcUMyQixvQ0FBckMsQ0FBMEVWLFVBQTFFLEVBQXNGTSxtQkFBdEYsQ0FBN0M7O0FBRUFOLHVCQUFhUyxvQ0FBYixDQUhxQyxDQUdlO0FBQ3JEOztBQUVELFlBQU1FLDBCQUEwQlgsV0FBV1ksZUFBWCxFQUFoQzs7QUFFQSxZQUFJRCx1QkFBSixFQUE2QjtBQUMzQixjQUFNRSw2QkFBNkIvQiwyQkFBMkJnQyxjQUEzQixDQUEwQ2QsVUFBMUMsQ0FBbkM7QUFBQSxjQUNNZSwyQkFBMkJuQyx5QkFBeUJrQyxjQUF6QixDQUF3Q2QsVUFBeEMsQ0FEakM7O0FBR0FILHNDQUE0Qm1CLElBQTVCLENBQWlDSCwwQkFBakM7O0FBRUFmLG9DQUEwQmtCLElBQTFCLENBQStCRCx3QkFBL0I7QUFDRCxTQVBELE1BT087QUFDTCxjQUFNRiw4QkFBNkJiLFVBQW5DLENBREssQ0FDMkM7O0FBRWhESCxzQ0FBNEJtQixJQUE1QixDQUFpQ0gsMkJBQWpDO0FBQ0Q7QUFDRixPQTNCRDs7QUE2QkFyQixvQkFBYyxHQUFHRCxNQUFILENBQVVNLDJCQUFWLEVBQXVDTixNQUF2QyxDQUE4Q08seUJBQTlDLENBQWQ7O0FBRUEsYUFBT04sV0FBUDtBQUNEOzs7Ozs7QUFHSHlCLE9BQU9DLE9BQVAsR0FBaUJsQyxVQUFqQjs7QUFFQSxTQUFTVSx3Q0FBVCxDQUFrREYsV0FBbEQsRUFBK0Q7QUFDN0QsTUFBTUMsNEJBQTRCRCxZQUFZTCxNQUFaLENBQW1CLFVBQVNNLHlCQUFULEVBQW9DTyxVQUFwQyxFQUFnRDtBQUNuRyxRQUFNbUIsMkJBQTJCdEMseUJBQXlCaUMsY0FBekIsQ0FBd0NkLFVBQXhDLENBQWpDOztBQUVBLFFBQUltQiw2QkFBNkIsSUFBakMsRUFBdUM7QUFDckMxQixnQ0FBMEJ1QixJQUExQixDQUErQkcsd0JBQS9CO0FBQ0Q7O0FBRUQsV0FBTzFCLHlCQUFQO0FBQ0QsR0FSaUMsRUFRL0IsRUFSK0IsQ0FBbEM7O0FBVUEsU0FBT0EseUJBQVA7QUFDRDs7QUFFRCxTQUFTRyxtQ0FBVCxDQUE2Q0gseUJBQTdDLEVBQXdFO0FBQ3RFLE1BQU1FLFNBQVNGLDBCQUEwQk4sTUFBMUIsQ0FBaUMsVUFBU1EsTUFBVCxFQUFpQndCLHdCQUFqQixFQUEyQztBQUN6RixRQUFNQywrQkFBK0JELHlCQUF5QkUsT0FBekIsRUFBckM7QUFBQSxRQUNNQywrQ0FBK0NILHlCQUF5QkksdUJBQXpCLEVBRHJEOztBQUdBRCxpREFBNkN2QixPQUE3QyxDQUFxRCxVQUFTeUIsMENBQVQsRUFBcUQ7QUFDeEcsVUFBTUMsZUFBZUwsNEJBQXJCO0FBQUEsVUFBb0Q7QUFDOUNNLHNCQUFnQkYsMENBRHRCO0FBQUEsVUFDa0U7QUFDNURHLGNBQVEsSUFBSWpELEtBQUosQ0FBVStDLFlBQVYsRUFBd0JDLGFBQXhCLENBRmQ7O0FBSUEvQixhQUFPcUIsSUFBUCxDQUFZVyxLQUFaO0FBQ0QsS0FORDs7QUFRQSxXQUFPaEMsTUFBUDtBQUNELEdBYmMsRUFhWixFQWJZLENBQWY7O0FBZUEsU0FBT0EsTUFBUDtBQUNEIiwiZmlsZSI6InBhcnNlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgVHVwbGUgPSByZXF1aXJlKCcuLi9jb21tb24vdHVwbGUnKSxcbiAgICAgIFJpZ2h0UmVjdXJzaXZlUHJvZHVjdGlvbiA9IHJlcXVpcmUoJy4uL2NvbW1vbi9wcm9kdWN0aW9uL3JpZ2h0UmVjdXJzaXZlJyksXG4gICAgICBQb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb24gPSByZXF1aXJlKCcuLi9jb21tb24vcHJvZHVjdGlvbi9wb3NzaWJseUN5Y2xpYycpLFxuICAgICAgTm9uTGVmdFJlY3Vyc2l2ZVByb2R1Y3Rpb24gPSByZXF1aXJlKCcuLi9jb21tb24vcHJvZHVjdGlvbi9ub25MZWZ0UmVjdXJzaXZlJyksXG4gICAgICBOb25JbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZVByb2R1Y3Rpb24gPSByZXF1aXJlKCcuLi9jb21tb24vcHJvZHVjdGlvbi9ub25JbXBsaWNpdGx5TGVmdFJlY3Vyc2l2ZScpO1xuXG5jbGFzcyBwYXJzZXJVdGlsIHtcbiAgc3RhdGljIHRva2Vuc0Zyb21MaW5lcyhsaW5lcykge1xuICAgIGNvbnN0IHRva2VucyA9IGxpbmVzLnJlZHVjZShmdW5jdGlvbih0b2tlbnMsIGxpbmUpIHtcbiAgICAgIGNvbnN0IGxpbmVUb2tlbnMgPSBsaW5lLmdldFRva2VucygpO1xuXG4gICAgICB0b2tlbnMgPSB0b2tlbnMuY29uY2F0KGxpbmVUb2tlbnMpO1xuXG4gICAgICByZXR1cm4gdG9rZW5zO1xuICAgIH0sIFtdKTtcblxuICAgIHJldHVybiB0b2tlbnM7XG4gIH1cblxuICBzdGF0aWMgZWxpbWluYXRlQ3ljbGVzKHByb2R1Y3Rpb25zKSB7XG4gICAgY29uc3QgcG9zc2libHlDeWNsaWNQcm9kdWN0aW9ucyA9IHBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvbnNGcm9tUHJvZHVjdGlvbnMocHJvZHVjdGlvbnMpLFxuICAgICAgICAgIHR1cGxlcyA9IHR1cGxlc0Zyb21Qb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb25zKHBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvbnMpO1xuXG4gICAgZGVidWdnZXJcblxuICAgIHJldHVybiBwcm9kdWN0aW9ucztcbiAgfVxuXG4gIHN0YXRpYyBlbGltaW5hdGVMZWZ0UmVjdXJzaW9uKHByb2R1Y3Rpb25zKSB7XG4gICAgY29uc3Qgbm9uTGVmdFJlY3Vyc2l2ZVByb2R1Y3Rpb25zID0gW10sXG4gICAgICAgICAgcmlnaHRSZWN1cnNpdmVQcm9kdWN0aW9ucyA9IFtdO1xuXG4gICAgcHJvZHVjdGlvbnMuZm9yRWFjaChmdW5jdGlvbihwcm9kdWN0aW9uLCBpbmRleCkge1xuICAgICAgY29uc3QgYmVnaW4gPSAwLFxuICAgICAgICAgICAgZW5kID0gaW5kZXgsICAvLy9cbiAgICAgICAgICAgIHByZXZpb3VzTm9uTGVmdFJlY3Vyc2l2ZVByb2R1Y3Rpb25zID0gbm9uTGVmdFJlY3Vyc2l2ZVByb2R1Y3Rpb25zLnNsaWNlKGJlZ2luLCBlbmQpLFxuICAgICAgICAgICAgcHJldmlvdXNQcm9kdWN0aW9ucyA9IHByZXZpb3VzTm9uTGVmdFJlY3Vyc2l2ZVByb2R1Y3Rpb25zLCAgLy8vXG4gICAgICAgICAgICBwcm9kdWN0aW9uSW1wbGljaXRseUxlZnRSZWN1cnNpdmUgPSBwcm9kdWN0aW9uLmlzSW1wbGljaXRseUxlZnRSZWN1cnNpdmUocHJldmlvdXNQcm9kdWN0aW9ucyk7XG5cbiAgICAgIGlmIChwcm9kdWN0aW9uSW1wbGljaXRseUxlZnRSZWN1cnNpdmUpIHtcbiAgICAgICAgY29uc3Qgbm9uSW1wbGljaXRseUxlZnRSZWN1cnNpdmVQcm9kdWN0aW9uID0gTm9uSW1wbGljaXRseUxlZnRSZWN1cnNpdmVQcm9kdWN0aW9uLmZyb21Qcm9kdWN0aW9uQW5kUHJldmlvdXNQcm9kdWN0aW9ucyhwcm9kdWN0aW9uLCBwcmV2aW91c1Byb2R1Y3Rpb25zKTtcblxuICAgICAgICBwcm9kdWN0aW9uID0gbm9uSW1wbGljaXRseUxlZnRSZWN1cnNpdmVQcm9kdWN0aW9uOyAgLy8vXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHByb2R1Y3Rpb25MZWZ0UmVjdXJzaXZlID0gcHJvZHVjdGlvbi5pc0xlZnRSZWN1cnNpdmUoKTtcblxuICAgICAgaWYgKHByb2R1Y3Rpb25MZWZ0UmVjdXJzaXZlKSB7XG4gICAgICAgIGNvbnN0IG5vbkxlZnRSZWN1cnNpdmVQcm9kdWN0aW9uID0gTm9uTGVmdFJlY3Vyc2l2ZVByb2R1Y3Rpb24uZnJvbVByb2R1Y3Rpb24ocHJvZHVjdGlvbiksXG4gICAgICAgICAgICAgIHJpZ2h0UmVjdXJzaXZlUHJvZHVjdGlvbiA9IFJpZ2h0UmVjdXJzaXZlUHJvZHVjdGlvbi5mcm9tUHJvZHVjdGlvbihwcm9kdWN0aW9uKTtcblxuICAgICAgICBub25MZWZ0UmVjdXJzaXZlUHJvZHVjdGlvbnMucHVzaChub25MZWZ0UmVjdXJzaXZlUHJvZHVjdGlvbik7XG5cbiAgICAgICAgcmlnaHRSZWN1cnNpdmVQcm9kdWN0aW9ucy5wdXNoKHJpZ2h0UmVjdXJzaXZlUHJvZHVjdGlvbik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBub25MZWZ0UmVjdXJzaXZlUHJvZHVjdGlvbiA9IHByb2R1Y3Rpb247ICAvLy9cblxuICAgICAgICBub25MZWZ0UmVjdXJzaXZlUHJvZHVjdGlvbnMucHVzaChub25MZWZ0UmVjdXJzaXZlUHJvZHVjdGlvbik7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBwcm9kdWN0aW9ucyA9IFtdLmNvbmNhdChub25MZWZ0UmVjdXJzaXZlUHJvZHVjdGlvbnMpLmNvbmNhdChyaWdodFJlY3Vyc2l2ZVByb2R1Y3Rpb25zKTtcblxuICAgIHJldHVybiBwcm9kdWN0aW9ucztcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHBhcnNlclV0aWw7XG5cbmZ1bmN0aW9uIHBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvbnNGcm9tUHJvZHVjdGlvbnMocHJvZHVjdGlvbnMpIHtcbiAgY29uc3QgcG9zc2libHlDeWNsaWNQcm9kdWN0aW9ucyA9IHByb2R1Y3Rpb25zLnJlZHVjZShmdW5jdGlvbihwb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb25zLCBwcm9kdWN0aW9uKSB7XG4gICAgY29uc3QgcG9zc2libHlDeWNsaWNQcm9kdWN0aW9uID0gUG9zc2libHlDeWNsaWNQcm9kdWN0aW9uLmZyb21Qcm9kdWN0aW9uKHByb2R1Y3Rpb24pO1xuXG4gICAgaWYgKHBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvbiAhPT0gbnVsbCkge1xuICAgICAgcG9zc2libHlDeWNsaWNQcm9kdWN0aW9ucy5wdXNoKHBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvbik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvbnM7XG4gIH0sIFtdKTtcblxuICByZXR1cm4gcG9zc2libHlDeWNsaWNQcm9kdWN0aW9ucztcbn1cblxuZnVuY3Rpb24gdHVwbGVzRnJvbVBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvbnMocG9zc2libHlDeWNsaWNQcm9kdWN0aW9ucykge1xuICBjb25zdCB0dXBsZXMgPSBwb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb25zLnJlZHVjZShmdW5jdGlvbih0dXBsZXMsIHBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvbikge1xuICAgIGNvbnN0IHBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvbk5hbWUgPSBwb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb24uZ2V0TmFtZSgpLFxuICAgICAgICAgIHBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvblJ1bGVzUHJvZHVjdGlvbk5hbWVzID0gcG9zc2libHlDeWNsaWNQcm9kdWN0aW9uLmdldFJ1bGVzUHJvZHVjdGlvbk5hbWVzKCk7XG5cbiAgICBwb3NzaWJseUN5Y2xpY1Byb2R1Y3Rpb25SdWxlc1Byb2R1Y3Rpb25OYW1lcy5mb3JFYWNoKGZ1bmN0aW9uKHBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvblJ1bGVQcm9kdWN0aW9uTmFtZSkge1xuICAgICAgY29uc3QgZmlyc3RFbGVtZW50ID0gcG9zc2libHlDeWNsaWNQcm9kdWN0aW9uTmFtZSwgIC8vL1xuICAgICAgICAgICAgc2Vjb25kRWxlbWVudCA9IHBvc3NpYmx5Q3ljbGljUHJvZHVjdGlvblJ1bGVQcm9kdWN0aW9uTmFtZSwgLy8vXG4gICAgICAgICAgICB0dXBsZSA9IG5ldyBUdXBsZShmaXJzdEVsZW1lbnQsIHNlY29uZEVsZW1lbnQpO1xuXG4gICAgICB0dXBsZXMucHVzaCh0dXBsZSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdHVwbGVzO1xuICB9LCBbXSk7XG5cbiAgcmV0dXJuIHR1cGxlcztcbn1cbiJdfQ==