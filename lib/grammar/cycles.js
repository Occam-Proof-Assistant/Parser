'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var tarjan = require('occam-tarjan');

var parserUtil = require('../util/parser'),
    Production = require('../bnf/production'),
    UnitDefinitionProduction = require('./production/unitDefinition'),
    UnitDefinitionsProduction = require('./production/unitDefinitions'),
    NonUnitDefinitionsProduction = require('./production/nonUnitDefinitions');

var Graph = tarjan.Graph;

var cycles = function () {
  function cycles() {
    _classCallCheck(this, cycles);
  }

  _createClass(cycles, null, [{
    key: 'eliminate',
    value: function eliminate(productions) {
      var graph = graphFromProductions(productions),
          components = graph.generateComponents(),
          nonCyclicProductions = nonCyclicProductionsFromComponents(components, productions);

      productions = productions.map(function (production) {
        var productionName = production.getName(),
            nonCyclicProductionName = productionName,
            ///
        alreadyNonCyclicProductionName = productionName,
            ///
        nonCyclicProduction = parserUtil.findProduction(nonCyclicProductionName, nonCyclicProductions),
            alreadyNonCyclicProduction = parserUtil.findProduction(alreadyNonCyclicProductionName, productions); ///

        production = nonCyclicProduction || alreadyNonCyclicProduction; ///

        return production;
      });

      return productions;
    }
  }]);

  return cycles;
}();

module.exports = cycles;

function graphFromProductions(productions) {
  var graph = new Graph(),
      unitDefinitionsProductions = unitDefinitionsProductionsFromProductions(productions);

  unitDefinitionsProductions.forEach(function (unitDefinitionsProduction) {
    var productionName = unitDefinitionsProduction.getName(),
        productionNames = unitDefinitionsProduction.getProductionNames(),
        unitDefinitionProductionNames = unitDefinitionProductionNamesFromProductionNames(productionNames, unitDefinitionsProductions),
        vertexName = productionName,
        ///
    descendantVertexNames = unitDefinitionProductionNames; ///

    graph.addVertex(vertexName, descendantVertexNames);
  });

  return graph;
}

function unitDefinitionsProductionsFromProductions(productions) {
  var unitDefinitionsProductions = productions.reduce(function (unitDefinitionsProductions, production) {
    var unitDefinitionsProduction = UnitDefinitionsProduction.fromProduction(production);

    if (unitDefinitionsProduction !== null) {
      unitDefinitionsProductions.push(unitDefinitionsProduction);
    }

    return unitDefinitionsProductions;
  }, []);

  return unitDefinitionsProductions;
}

function unitDefinitionProductionNamesFromProductionNames(productionNames, unitDefinitionProductions) {
  var unitDefinitionProductionNames = productionNames.reduce(function (unitDefinitionProductionNames, productionName) {
    var unitDefinitionProductionName = productionName,
        ///
    unitDefinitionProduction = parserUtil.findProduction(unitDefinitionProductionName, unitDefinitionProductions);

    if (unitDefinitionProduction !== null) {
      var _unitDefinitionProductionName = productionName; ///

      unitDefinitionProductionNames.push(_unitDefinitionProductionName);
    }

    return unitDefinitionProductionNames;
  }, []);

  return unitDefinitionProductionNames;
}

function nonCyclicProductionsFromComponents(components, productions) {
  var nonCyclicProductions = components.reduce(function (nonCyclicProductions, component) {
    var componentNonCyclic = component.isNonCyclic();

    if (componentNonCyclic) {
      nonCyclicProductionFromComponent(component, productions, nonCyclicProductions);
    } else {
      nonCyclicProductionsFromComponent(component, productions, nonCyclicProductions);
    }

    return nonCyclicProductions;
  }, []);

  return nonCyclicProductions;
}

function nonCyclicProductionFromComponent(component, productions, nonCyclicProductions) {
  var firstVertex = component.getFirstVertex(),
      firstVertexName = firstVertex.getName(),
      nonCyclicProductionName = firstVertexName,
      ///
  nonCyclicProduction = parserUtil.findProduction(nonCyclicProductionName, productions);

  if (nonCyclicProduction !== null) {
    ///
    nonCyclicProductions.push(nonCyclicProduction);
  }
}

function nonCyclicProductionsFromComponent(component, productions, nonCyclicProductions) {
  var unitDefinitionProductions = unitDefinitionProductionsFromComponent(component, productions),
      fixedNonUnitDefinitionsProductions = fixedNonUnitDefinitionsProductionsFromProductions(productions),
      addedNonUnitDefinitionsProductions = [],
      removedUnitDefinitionProductions = [];

  var unitDefinitionProductionsLength = unitDefinitionProductions.length;

  while (unitDefinitionProductionsLength > 0) {
    var unitDefinitionProduction = unitDefinitionProductions.shift(),
        unitDefinitionProductionName = unitDefinitionProduction.getName();

    var removedUnitDefinitionProduction = unitDefinitionProduction; ///

    removedUnitDefinitionProductions.push(removedUnitDefinitionProduction);

    var unitDefinitionProductionUnitDefinitionProductionName = unitDefinitionProduction.getUnitDefinitionProductionName(),
        fixedNonUnitDefinitionsProductionName = unitDefinitionProductionUnitDefinitionProductionName,
        ///
    fixedNonUnitDefinitionsProduction = parserUtil.findProduction(fixedNonUnitDefinitionsProductionName, fixedNonUnitDefinitionsProductions),
        addedNonUnitDefinitionsProductionName = unitDefinitionProductionName; ///

    var addedNonUnitDefinitionsProduction = parserUtil.findProduction(addedNonUnitDefinitionsProductionName, addedNonUnitDefinitionsProductions);

    if (addedNonUnitDefinitionsProduction === null) {
      addedNonUnitDefinitionsProduction = Production.fromProduction(fixedNonUnitDefinitionsProduction);

      addedNonUnitDefinitionsProduction.setName(addedNonUnitDefinitionsProductionName);

      addedNonUnitDefinitionsProductions.push(addedNonUnitDefinitionsProduction);
    } else {
      var fixedNonUnitDefinitionsProductionDefinitions = fixedNonUnitDefinitionsProduction.getDefinitions();

      addedNonUnitDefinitionsProduction.addDefinitions(fixedNonUnitDefinitionsProductionDefinitions);
    }

    var intermediateUnitDefinitionProductionName = unitDefinitionProductionUnitDefinitionProductionName,
        ///
    intermediateUnitDefinitionProduction = parserUtil.findProduction(intermediateUnitDefinitionProductionName, unitDefinitionProductions);

    if (intermediateUnitDefinitionProduction !== null) {
      var intermediateUnitDefinitionProductionUnitDefinitionProductionName = intermediateUnitDefinitionProduction.getUnitDefinitionProductionName(),
          firstProductionName = unitDefinitionProductionName,
          ///
      secondProductionName = intermediateUnitDefinitionProductionUnitDefinitionProductionName,
          ///
      unitDefinitionProductionNonCyclic = firstProductionName !== secondProductionName;

      if (unitDefinitionProductionNonCyclic) {
        unitDefinitionProduction = findUnitDefinitionProduction(firstProductionName, secondProductionName, removedUnitDefinitionProductions);

        if (unitDefinitionProduction === null) {
          unitDefinitionProduction = UnitDefinitionProduction.fromProductionNames(firstProductionName, secondProductionName);

          unitDefinitionProductions.unshift(unitDefinitionProduction);
        }
      }
    }

    unitDefinitionProductionsLength = unitDefinitionProductions.length;
  }

  nonCyclicProductionsFromFixedAndAddedProductions(fixedNonUnitDefinitionsProductions, addedNonUnitDefinitionsProductions, nonCyclicProductions);
}

function nonCyclicProductionsFromFixedAndAddedProductions(fixedNonUnitDefinitionsProductions, addedNonUnitDefinitionsProductions, nonCyclicProductions) {
  fixedNonUnitDefinitionsProductions.forEach(function (fixedNonUnitDefinitionsProduction) {
    var nonCyclicProduction = fixedNonUnitDefinitionsProduction,
        ///
    nonCyclicProductionName = nonCyclicProduction.getName(),
        addedNonUnitDefinitionsProductionName = nonCyclicProductionName,
        ///
    addedNonUnitDefinitionsProduction = parserUtil.findProduction(addedNonUnitDefinitionsProductionName, addedNonUnitDefinitionsProductions);

    if (addedNonUnitDefinitionsProduction !== null) {
      var addedNonUnitDefinitionsProductionDefinitions = addedNonUnitDefinitionsProduction.getDefinitions();

      nonCyclicProduction.addDefinitions(addedNonUnitDefinitionsProductionDefinitions);
    }

    var nonCyclicProductionDefinitionsExist = nonCyclicProduction.doDefinitionsExist();

    if (nonCyclicProductionDefinitionsExist) {
      nonCyclicProductions.push(nonCyclicProduction);
    }
  });
}

function unitDefinitionProductionsFromComponent(component, productions, nonCyclicProductions) {
  var unitDefinitionsProductions = unitDefinitionsProductionsFromComponent(component, productions),
      unitDefinitionProductions = unitDefinitionProductionsFromUnitDefinitionsProductions(unitDefinitionsProductions);

  return unitDefinitionProductions;
}

function unitDefinitionsProductionsFromComponent(component, productions) {
  var unitDefinitionsProductions = component.mapVertices(function (vertex) {
    var vertexName = vertex.getName(),
        productionName = vertexName,
        ///
    production = parserUtil.findProduction(productionName, productions),
        unitDefinitionsProduction = UnitDefinitionsProduction.fromProduction(production);

    return unitDefinitionsProduction;
  });

  return unitDefinitionsProductions;
}

function fixedNonUnitDefinitionsProductionsFromProductions(productions) {
  var fixedNonUnitDefinitionsProductions = productions.map(function (production) {
    var nonUnitDefinitionsProduction = NonUnitDefinitionsProduction.fromProduction(production),
        fixedNonUnitDefinitionsProduction = nonUnitDefinitionsProduction; ///

    return fixedNonUnitDefinitionsProduction;
  });

  return fixedNonUnitDefinitionsProductions;
}

function unitDefinitionProductionsFromUnitDefinitionsProductions(unitDefinitionsProductions) {
  var unitDefinitionProductions = unitDefinitionsProductions.reduce(function (unitDefinitionProductions, unitDefinitionsProduction) {
    var unitDefinitionsProductionName = unitDefinitionsProduction.getName();

    unitDefinitionsProduction.forEachUnitDefinition(function (unitDefinition) {
      var name = unitDefinitionsProductionName,
          ///
      unitDefinitionProduction = UnitDefinitionProduction.fromNameAndUnitDefinition(name, unitDefinition);

      unitDefinitionProductions.push(unitDefinitionProduction);
    });

    return unitDefinitionProductions;
  }, []);

  return unitDefinitionProductions;
}

function findUnitDefinitionProduction(firstProductionName, secondProductionName, unitDefinitionProductions) {
  var foundUnitDefinitionProduction = null;

  unitDefinitionProductions.some(function (unitDefinitionProduction) {
    var unitDefinitionProductionFound = unitDefinitionProduction.isFoundByProductionNames(firstProductionName, secondProductionName);

    if (unitDefinitionProductionFound) {
      foundUnitDefinitionProduction = unitDefinitionProduction;

      return true;
    }
  });

  var unitDefinitionProduction = foundUnitDefinitionProduction; ///

  return unitDefinitionProduction;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi9ncmFtbWFyL2N5Y2xlcy5qcyJdLCJuYW1lcyI6WyJ0YXJqYW4iLCJyZXF1aXJlIiwicGFyc2VyVXRpbCIsIlByb2R1Y3Rpb24iLCJVbml0RGVmaW5pdGlvblByb2R1Y3Rpb24iLCJVbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uIiwiTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbiIsIkdyYXBoIiwiY3ljbGVzIiwicHJvZHVjdGlvbnMiLCJncmFwaCIsImdyYXBoRnJvbVByb2R1Y3Rpb25zIiwiY29tcG9uZW50cyIsImdlbmVyYXRlQ29tcG9uZW50cyIsIm5vbkN5Y2xpY1Byb2R1Y3Rpb25zIiwibm9uQ3ljbGljUHJvZHVjdGlvbnNGcm9tQ29tcG9uZW50cyIsIm1hcCIsInByb2R1Y3Rpb24iLCJwcm9kdWN0aW9uTmFtZSIsImdldE5hbWUiLCJub25DeWNsaWNQcm9kdWN0aW9uTmFtZSIsImFscmVhZHlOb25DeWNsaWNQcm9kdWN0aW9uTmFtZSIsIm5vbkN5Y2xpY1Byb2R1Y3Rpb24iLCJmaW5kUHJvZHVjdGlvbiIsImFscmVhZHlOb25DeWNsaWNQcm9kdWN0aW9uIiwibW9kdWxlIiwiZXhwb3J0cyIsInVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25zIiwidW5pdERlZmluaXRpb25zUHJvZHVjdGlvbnNGcm9tUHJvZHVjdGlvbnMiLCJmb3JFYWNoIiwidW5pdERlZmluaXRpb25zUHJvZHVjdGlvbiIsInByb2R1Y3Rpb25OYW1lcyIsImdldFByb2R1Y3Rpb25OYW1lcyIsInVuaXREZWZpbml0aW9uUHJvZHVjdGlvbk5hbWVzIiwidW5pdERlZmluaXRpb25Qcm9kdWN0aW9uTmFtZXNGcm9tUHJvZHVjdGlvbk5hbWVzIiwidmVydGV4TmFtZSIsImRlc2NlbmRhbnRWZXJ0ZXhOYW1lcyIsImFkZFZlcnRleCIsInJlZHVjZSIsImZyb21Qcm9kdWN0aW9uIiwicHVzaCIsInVuaXREZWZpbml0aW9uUHJvZHVjdGlvbnMiLCJ1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25OYW1lIiwidW5pdERlZmluaXRpb25Qcm9kdWN0aW9uIiwiY29tcG9uZW50IiwiY29tcG9uZW50Tm9uQ3ljbGljIiwiaXNOb25DeWNsaWMiLCJub25DeWNsaWNQcm9kdWN0aW9uRnJvbUNvbXBvbmVudCIsIm5vbkN5Y2xpY1Byb2R1Y3Rpb25zRnJvbUNvbXBvbmVudCIsImZpcnN0VmVydGV4IiwiZ2V0Rmlyc3RWZXJ0ZXgiLCJmaXJzdFZlcnRleE5hbWUiLCJ1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25zRnJvbUNvbXBvbmVudCIsImZpeGVkTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbnMiLCJmaXhlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25zRnJvbVByb2R1Y3Rpb25zIiwiYWRkZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9ucyIsInJlbW92ZWRVbml0RGVmaW5pdGlvblByb2R1Y3Rpb25zIiwidW5pdERlZmluaXRpb25Qcm9kdWN0aW9uc0xlbmd0aCIsImxlbmd0aCIsInNoaWZ0IiwicmVtb3ZlZFVuaXREZWZpbml0aW9uUHJvZHVjdGlvbiIsInVuaXREZWZpbml0aW9uUHJvZHVjdGlvblVuaXREZWZpbml0aW9uUHJvZHVjdGlvbk5hbWUiLCJnZXRVbml0RGVmaW5pdGlvblByb2R1Y3Rpb25OYW1lIiwiZml4ZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uTmFtZSIsImZpeGVkTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbiIsImFkZGVkTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbk5hbWUiLCJhZGRlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb24iLCJzZXROYW1lIiwiZml4ZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uRGVmaW5pdGlvbnMiLCJnZXREZWZpbml0aW9ucyIsImFkZERlZmluaXRpb25zIiwiaW50ZXJtZWRpYXRlVW5pdERlZmluaXRpb25Qcm9kdWN0aW9uTmFtZSIsImludGVybWVkaWF0ZVVuaXREZWZpbml0aW9uUHJvZHVjdGlvbiIsImludGVybWVkaWF0ZVVuaXREZWZpbml0aW9uUHJvZHVjdGlvblVuaXREZWZpbml0aW9uUHJvZHVjdGlvbk5hbWUiLCJmaXJzdFByb2R1Y3Rpb25OYW1lIiwic2Vjb25kUHJvZHVjdGlvbk5hbWUiLCJ1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25Ob25DeWNsaWMiLCJmaW5kVW5pdERlZmluaXRpb25Qcm9kdWN0aW9uIiwiZnJvbVByb2R1Y3Rpb25OYW1lcyIsInVuc2hpZnQiLCJub25DeWNsaWNQcm9kdWN0aW9uc0Zyb21GaXhlZEFuZEFkZGVkUHJvZHVjdGlvbnMiLCJhZGRlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25EZWZpbml0aW9ucyIsIm5vbkN5Y2xpY1Byb2R1Y3Rpb25EZWZpbml0aW9uc0V4aXN0IiwiZG9EZWZpbml0aW9uc0V4aXN0IiwidW5pdERlZmluaXRpb25zUHJvZHVjdGlvbnNGcm9tQ29tcG9uZW50IiwidW5pdERlZmluaXRpb25Qcm9kdWN0aW9uc0Zyb21Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9ucyIsIm1hcFZlcnRpY2VzIiwidmVydGV4Iiwibm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbiIsInVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25OYW1lIiwiZm9yRWFjaFVuaXREZWZpbml0aW9uIiwidW5pdERlZmluaXRpb24iLCJuYW1lIiwiZnJvbU5hbWVBbmRVbml0RGVmaW5pdGlvbiIsImZvdW5kVW5pdERlZmluaXRpb25Qcm9kdWN0aW9uIiwic29tZSIsInVuaXREZWZpbml0aW9uUHJvZHVjdGlvbkZvdW5kIiwiaXNGb3VuZEJ5UHJvZHVjdGlvbk5hbWVzIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7O0FBRUEsSUFBTUEsU0FBU0MsUUFBUSxjQUFSLENBQWY7O0FBRUEsSUFBTUMsYUFBYUQsUUFBUSxnQkFBUixDQUFuQjtBQUFBLElBQ01FLGFBQWFGLFFBQVEsbUJBQVIsQ0FEbkI7QUFBQSxJQUVNRywyQkFBMkJILFFBQVEsNkJBQVIsQ0FGakM7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OztBQUVELFNBQVNnQyx1REFBVCxDQUFpRTFELDBCQUFqRSxFQUE2RjtBQUMzRixNQUFNYyw0QkFBNEJkLDJCQUEyQlcsTUFBM0IsQ0FBa0MsVUFBU0cseUJBQVQsRUFBb0NYLHlCQUFwQyxFQUErRDtBQUNqSSxRQUFNMkQsZ0NBQWdDM0QsMEJBQTBCWCxPQUExQixFQUF0Qzs7QUFFQVcsOEJBQTBCNEQscUJBQTFCLENBQWdELFVBQVNDLGNBQVQsRUFBeUI7QUFDdkUsVUFBTUMsT0FBT0gsNkJBQWI7QUFBQSxVQUE0QztBQUN0QzlDLGlDQUEyQnZDLHlCQUF5QnlGLHlCQUF6QixDQUFtREQsSUFBbkQsRUFBeURELGNBQXpELENBRGpDOztBQUdBbEQsZ0NBQTBCRCxJQUExQixDQUErQkcsd0JBQS9CO0FBQ0QsS0FMRDs7QUFPQSxXQUFPRix5QkFBUDtBQUNELEdBWGlDLEVBVy9CLEVBWCtCLENBQWxDOztBQWFBLFNBQU9BLHlCQUFQO0FBQ0Q7O0FBRUQsU0FBU29DLDRCQUFULENBQXNDSCxtQkFBdEMsRUFBMkRDLG9CQUEzRCxFQUFpRmxDLHlCQUFqRixFQUE0RztBQUMxRyxNQUFJcUQsZ0NBQWdDLElBQXBDOztBQUVBckQsNEJBQTBCc0QsSUFBMUIsQ0FBK0IsVUFBU3BELHdCQUFULEVBQW1DO0FBQ2hFLFFBQU1xRCxnQ0FBZ0NyRCx5QkFBeUJzRCx3QkFBekIsQ0FBa0R2QixtQkFBbEQsRUFBdUVDLG9CQUF2RSxDQUF0Qzs7QUFFQSxRQUFJcUIsNkJBQUosRUFBbUM7QUFDakNGLHNDQUFnQ25ELHdCQUFoQzs7QUFFQSxhQUFPLElBQVA7QUFDRDtBQUNGLEdBUkQ7O0FBVUEsTUFBTUEsMkJBQTJCbUQsNkJBQWpDLENBYjBHLENBYTFDOztBQUVoRSxTQUFPbkQsd0JBQVA7QUFDRCIsImZpbGUiOiJjeWNsZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IHRhcmphbiA9IHJlcXVpcmUoJ29jY2FtLXRhcmphbicpO1xuXG5jb25zdCBwYXJzZXJVdGlsID0gcmVxdWlyZSgnLi4vdXRpbC9wYXJzZXInKSxcbiAgICAgIFByb2R1Y3Rpb24gPSByZXF1aXJlKCcuLi9ibmYvcHJvZHVjdGlvbicpLFxuICAgICAgVW5pdERlZmluaXRpb25Qcm9kdWN0aW9uID0gcmVxdWlyZSgnLi9wcm9kdWN0aW9uL3VuaXREZWZpbml0aW9uJyksXG4gICAgICBVbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uID0gcmVxdWlyZSgnLi9wcm9kdWN0aW9uL3VuaXREZWZpbml0aW9ucycpLFxuICAgICAgTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbiA9IHJlcXVpcmUoJy4vcHJvZHVjdGlvbi9ub25Vbml0RGVmaW5pdGlvbnMnKTtcblxuY29uc3QgeyBHcmFwaCB9ID0gdGFyamFuO1xuXG5jbGFzcyBjeWNsZXMge1xuICBzdGF0aWMgZWxpbWluYXRlKHByb2R1Y3Rpb25zKSB7XG4gICAgY29uc3QgZ3JhcGggPSBncmFwaEZyb21Qcm9kdWN0aW9ucyhwcm9kdWN0aW9ucyksXG4gICAgICAgICAgY29tcG9uZW50cyA9IGdyYXBoLmdlbmVyYXRlQ29tcG9uZW50cygpLFxuICAgICAgICAgIG5vbkN5Y2xpY1Byb2R1Y3Rpb25zID0gbm9uQ3ljbGljUHJvZHVjdGlvbnNGcm9tQ29tcG9uZW50cyhjb21wb25lbnRzLCBwcm9kdWN0aW9ucyk7XG5cbiAgICBwcm9kdWN0aW9ucyA9IHByb2R1Y3Rpb25zLm1hcChmdW5jdGlvbihwcm9kdWN0aW9uKSB7XG4gICAgICBjb25zdCBwcm9kdWN0aW9uTmFtZSA9IHByb2R1Y3Rpb24uZ2V0TmFtZSgpLFxuICAgICAgICAgICAgbm9uQ3ljbGljUHJvZHVjdGlvbk5hbWUgPSBwcm9kdWN0aW9uTmFtZSwgLy8vXG4gICAgICAgICAgICBhbHJlYWR5Tm9uQ3ljbGljUHJvZHVjdGlvbk5hbWUgPSBwcm9kdWN0aW9uTmFtZSwgIC8vL1xuICAgICAgICAgICAgbm9uQ3ljbGljUHJvZHVjdGlvbiA9IHBhcnNlclV0aWwuZmluZFByb2R1Y3Rpb24obm9uQ3ljbGljUHJvZHVjdGlvbk5hbWUsIG5vbkN5Y2xpY1Byb2R1Y3Rpb25zKSxcbiAgICAgICAgICAgIGFscmVhZHlOb25DeWNsaWNQcm9kdWN0aW9uID0gcGFyc2VyVXRpbC5maW5kUHJvZHVjdGlvbihhbHJlYWR5Tm9uQ3ljbGljUHJvZHVjdGlvbk5hbWUsIHByb2R1Y3Rpb25zKTsgIC8vL1xuXG4gICAgICBwcm9kdWN0aW9uID0gbm9uQ3ljbGljUHJvZHVjdGlvbiB8fCBhbHJlYWR5Tm9uQ3ljbGljUHJvZHVjdGlvbjsgLy8vXG5cbiAgICAgIHJldHVybiBwcm9kdWN0aW9uO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHByb2R1Y3Rpb25zO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gY3ljbGVzO1xuXG5mdW5jdGlvbiBncmFwaEZyb21Qcm9kdWN0aW9ucyhwcm9kdWN0aW9ucykge1xuICBjb25zdCBncmFwaCA9IG5ldyBHcmFwaCgpLFxuICAgICAgICB1bml0RGVmaW5pdGlvbnNQcm9kdWN0aW9ucyA9IHVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25zRnJvbVByb2R1Y3Rpb25zKHByb2R1Y3Rpb25zKTtcblxuICB1bml0RGVmaW5pdGlvbnNQcm9kdWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKHVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb24pIHtcbiAgICBjb25zdCBwcm9kdWN0aW9uTmFtZSA9IHVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb24uZ2V0TmFtZSgpLFxuICAgICAgICAgIHByb2R1Y3Rpb25OYW1lcyA9IHVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb24uZ2V0UHJvZHVjdGlvbk5hbWVzKCksXG4gICAgICAgICAgdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uTmFtZXMgPSB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25OYW1lc0Zyb21Qcm9kdWN0aW9uTmFtZXMocHJvZHVjdGlvbk5hbWVzLCB1bml0RGVmaW5pdGlvbnNQcm9kdWN0aW9ucyksXG4gICAgICAgICAgdmVydGV4TmFtZSA9IHByb2R1Y3Rpb25OYW1lLCAgLy8vXG4gICAgICAgICAgZGVzY2VuZGFudFZlcnRleE5hbWVzID0gdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uTmFtZXM7IC8vL1xuXG4gICAgZ3JhcGguYWRkVmVydGV4KHZlcnRleE5hbWUsIGRlc2NlbmRhbnRWZXJ0ZXhOYW1lcyk7XG4gIH0pO1xuXG4gIHJldHVybiBncmFwaDtcbn1cblxuZnVuY3Rpb24gdW5pdERlZmluaXRpb25zUHJvZHVjdGlvbnNGcm9tUHJvZHVjdGlvbnMocHJvZHVjdGlvbnMpIHtcbiAgY29uc3QgdW5pdERlZmluaXRpb25zUHJvZHVjdGlvbnMgPSBwcm9kdWN0aW9ucy5yZWR1Y2UoZnVuY3Rpb24odW5pdERlZmluaXRpb25zUHJvZHVjdGlvbnMsIHByb2R1Y3Rpb24pIHtcbiAgICBjb25zdCB1bml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uID0gVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbi5mcm9tUHJvZHVjdGlvbihwcm9kdWN0aW9uKTtcblxuICAgIGlmICh1bml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uICE9PSBudWxsKSB7XG4gICAgICB1bml0RGVmaW5pdGlvbnNQcm9kdWN0aW9ucy5wdXNoKHVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb24pO1xuICAgIH1cblxuICAgIHJldHVybiB1bml0RGVmaW5pdGlvbnNQcm9kdWN0aW9ucztcbiAgfSwgW10pO1xuXG4gIHJldHVybiB1bml0RGVmaW5pdGlvbnNQcm9kdWN0aW9ucztcbn1cblxuZnVuY3Rpb24gdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uTmFtZXNGcm9tUHJvZHVjdGlvbk5hbWVzKHByb2R1Y3Rpb25OYW1lcywgdW5pdERlZmluaXRpb25Qcm9kdWN0aW9ucykge1xuICBjb25zdCB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25OYW1lcyA9IHByb2R1Y3Rpb25OYW1lcy5yZWR1Y2UoZnVuY3Rpb24odW5pdERlZmluaXRpb25Qcm9kdWN0aW9uTmFtZXMsIHByb2R1Y3Rpb25OYW1lKSB7XG4gICAgY29uc3QgdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uTmFtZSA9IHByb2R1Y3Rpb25OYW1lLCAgLy8vXG4gICAgICAgICAgdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uID0gcGFyc2VyVXRpbC5maW5kUHJvZHVjdGlvbih1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25OYW1lLCB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25zKTtcbiAgICBcbiAgICBpZiAodW5pdERlZmluaXRpb25Qcm9kdWN0aW9uICE9PSBudWxsKSB7XG4gICAgICBjb25zdCB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25OYW1lID0gcHJvZHVjdGlvbk5hbWU7ICAvLy9cblxuICAgICAgdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uTmFtZXMucHVzaCh1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25OYW1lKTtcbiAgICB9ICAgIFxuICAgIFxuICAgIHJldHVybiB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25OYW1lcztcbiAgfSwgW10pO1xuXG4gIHJldHVybiB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25OYW1lcztcbn1cblxuZnVuY3Rpb24gbm9uQ3ljbGljUHJvZHVjdGlvbnNGcm9tQ29tcG9uZW50cyhjb21wb25lbnRzLCBwcm9kdWN0aW9ucykge1xuICBjb25zdCBub25DeWNsaWNQcm9kdWN0aW9ucyA9IGNvbXBvbmVudHMucmVkdWNlKGZ1bmN0aW9uKG5vbkN5Y2xpY1Byb2R1Y3Rpb25zLCBjb21wb25lbnQpIHtcbiAgICAgICAgICBjb25zdCBjb21wb25lbnROb25DeWNsaWMgPSBjb21wb25lbnQuaXNOb25DeWNsaWMoKTtcblxuICAgICAgICAgIGlmIChjb21wb25lbnROb25DeWNsaWMpIHtcbiAgICAgICAgICAgIG5vbkN5Y2xpY1Byb2R1Y3Rpb25Gcm9tQ29tcG9uZW50KGNvbXBvbmVudCwgcHJvZHVjdGlvbnMsIG5vbkN5Y2xpY1Byb2R1Y3Rpb25zKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbm9uQ3ljbGljUHJvZHVjdGlvbnNGcm9tQ29tcG9uZW50KGNvbXBvbmVudCwgcHJvZHVjdGlvbnMsIG5vbkN5Y2xpY1Byb2R1Y3Rpb25zKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gbm9uQ3ljbGljUHJvZHVjdGlvbnM7XG4gICAgICAgIH0sIFtdKTtcblxuICByZXR1cm4gbm9uQ3ljbGljUHJvZHVjdGlvbnM7XG59XG5cbmZ1bmN0aW9uIG5vbkN5Y2xpY1Byb2R1Y3Rpb25Gcm9tQ29tcG9uZW50KGNvbXBvbmVudCwgcHJvZHVjdGlvbnMsIG5vbkN5Y2xpY1Byb2R1Y3Rpb25zKSB7XG4gIGNvbnN0IGZpcnN0VmVydGV4ID0gY29tcG9uZW50LmdldEZpcnN0VmVydGV4KCksXG4gICAgICAgIGZpcnN0VmVydGV4TmFtZSA9IGZpcnN0VmVydGV4LmdldE5hbWUoKSxcbiAgICAgICAgbm9uQ3ljbGljUHJvZHVjdGlvbk5hbWUgPSBmaXJzdFZlcnRleE5hbWUsICAvLy9cbiAgICAgICAgbm9uQ3ljbGljUHJvZHVjdGlvbiA9IHBhcnNlclV0aWwuZmluZFByb2R1Y3Rpb24obm9uQ3ljbGljUHJvZHVjdGlvbk5hbWUsIHByb2R1Y3Rpb25zKTtcblxuICBpZiAobm9uQ3ljbGljUHJvZHVjdGlvbiAhPT0gbnVsbCkgeyAvLy9cbiAgICBub25DeWNsaWNQcm9kdWN0aW9ucy5wdXNoKG5vbkN5Y2xpY1Byb2R1Y3Rpb24pO1xuICB9XG59XG5cbmZ1bmN0aW9uIG5vbkN5Y2xpY1Byb2R1Y3Rpb25zRnJvbUNvbXBvbmVudChjb21wb25lbnQsIHByb2R1Y3Rpb25zLCBub25DeWNsaWNQcm9kdWN0aW9ucykge1xuICBjb25zdCB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25zID0gdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uc0Zyb21Db21wb25lbnQoY29tcG9uZW50LCBwcm9kdWN0aW9ucyksXG4gICAgICAgIGZpeGVkTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbnMgPSBmaXhlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25zRnJvbVByb2R1Y3Rpb25zKHByb2R1Y3Rpb25zKSxcbiAgICAgICAgYWRkZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9ucyA9IFtdLFxuICAgICAgICByZW1vdmVkVW5pdERlZmluaXRpb25Qcm9kdWN0aW9ucyA9IFtdO1xuXG4gIGxldCB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25zTGVuZ3RoID0gdW5pdERlZmluaXRpb25Qcm9kdWN0aW9ucy5sZW5ndGg7XG5cbiAgd2hpbGUgKHVuaXREZWZpbml0aW9uUHJvZHVjdGlvbnNMZW5ndGggPiAwKSB7XG4gICAgbGV0IHVuaXREZWZpbml0aW9uUHJvZHVjdGlvbiA9IHVuaXREZWZpbml0aW9uUHJvZHVjdGlvbnMuc2hpZnQoKSxcbiAgICAgICAgdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uTmFtZSA9IHVuaXREZWZpbml0aW9uUHJvZHVjdGlvbi5nZXROYW1lKCk7XG5cbiAgICBjb25zdCByZW1vdmVkVW5pdERlZmluaXRpb25Qcm9kdWN0aW9uID0gdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uOyAvLy9cblxuICAgIHJlbW92ZWRVbml0RGVmaW5pdGlvblByb2R1Y3Rpb25zLnB1c2gocmVtb3ZlZFVuaXREZWZpbml0aW9uUHJvZHVjdGlvbik7XG5cbiAgICBjb25zdCB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25Vbml0RGVmaW5pdGlvblByb2R1Y3Rpb25OYW1lID0gdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uLmdldFVuaXREZWZpbml0aW9uUHJvZHVjdGlvbk5hbWUoKSxcbiAgICAgICAgICBmaXhlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25OYW1lID0gdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uVW5pdERlZmluaXRpb25Qcm9kdWN0aW9uTmFtZSwgIC8vL1xuICAgICAgICAgIGZpeGVkTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbiA9IHBhcnNlclV0aWwuZmluZFByb2R1Y3Rpb24oZml4ZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uTmFtZSwgZml4ZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9ucyksXG4gICAgICAgICAgYWRkZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uTmFtZSA9IHVuaXREZWZpbml0aW9uUHJvZHVjdGlvbk5hbWU7ICAvLy9cblxuICAgIGxldCBhZGRlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb24gPSBwYXJzZXJVdGlsLmZpbmRQcm9kdWN0aW9uKGFkZGVkTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbk5hbWUsIGFkZGVkTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbnMpO1xuXG4gICAgaWYgKGFkZGVkTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbiA9PT0gbnVsbCkge1xuICAgICAgYWRkZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uID0gUHJvZHVjdGlvbi5mcm9tUHJvZHVjdGlvbihmaXhlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb24pO1xuXG4gICAgICBhZGRlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb24uc2V0TmFtZShhZGRlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25OYW1lKTtcblxuICAgICAgYWRkZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9ucy5wdXNoKGFkZGVkTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGZpeGVkTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbkRlZmluaXRpb25zID0gZml4ZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uLmdldERlZmluaXRpb25zKCk7XG5cbiAgICAgIGFkZGVkTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbi5hZGREZWZpbml0aW9ucyhmaXhlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25EZWZpbml0aW9ucyk7XG4gICAgfVxuXG4gICAgY29uc3QgaW50ZXJtZWRpYXRlVW5pdERlZmluaXRpb25Qcm9kdWN0aW9uTmFtZSA9IHVuaXREZWZpbml0aW9uUHJvZHVjdGlvblVuaXREZWZpbml0aW9uUHJvZHVjdGlvbk5hbWUsIC8vL1xuICAgICAgICAgIGludGVybWVkaWF0ZVVuaXREZWZpbml0aW9uUHJvZHVjdGlvbiA9IHBhcnNlclV0aWwuZmluZFByb2R1Y3Rpb24oaW50ZXJtZWRpYXRlVW5pdERlZmluaXRpb25Qcm9kdWN0aW9uTmFtZSwgdW5pdERlZmluaXRpb25Qcm9kdWN0aW9ucyk7XG5cbiAgICBpZiAoaW50ZXJtZWRpYXRlVW5pdERlZmluaXRpb25Qcm9kdWN0aW9uICE9PSBudWxsKSB7XG4gICAgICBjb25zdCBpbnRlcm1lZGlhdGVVbml0RGVmaW5pdGlvblByb2R1Y3Rpb25Vbml0RGVmaW5pdGlvblByb2R1Y3Rpb25OYW1lID0gaW50ZXJtZWRpYXRlVW5pdERlZmluaXRpb25Qcm9kdWN0aW9uLmdldFVuaXREZWZpbml0aW9uUHJvZHVjdGlvbk5hbWUoKSxcbiAgICAgICAgICAgIGZpcnN0UHJvZHVjdGlvbk5hbWUgPSB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25OYW1lLCAgLy8vXG4gICAgICAgICAgICBzZWNvbmRQcm9kdWN0aW9uTmFtZSA9IGludGVybWVkaWF0ZVVuaXREZWZpbml0aW9uUHJvZHVjdGlvblVuaXREZWZpbml0aW9uUHJvZHVjdGlvbk5hbWUsICAvLy9cbiAgICAgICAgICAgIHVuaXREZWZpbml0aW9uUHJvZHVjdGlvbk5vbkN5Y2xpYyA9IChmaXJzdFByb2R1Y3Rpb25OYW1lICE9PSBzZWNvbmRQcm9kdWN0aW9uTmFtZSk7XG5cbiAgICAgIGlmICh1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25Ob25DeWNsaWMpIHtcbiAgICAgICAgdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uID0gZmluZFVuaXREZWZpbml0aW9uUHJvZHVjdGlvbihmaXJzdFByb2R1Y3Rpb25OYW1lLCBzZWNvbmRQcm9kdWN0aW9uTmFtZSwgcmVtb3ZlZFVuaXREZWZpbml0aW9uUHJvZHVjdGlvbnMpO1xuXG4gICAgICAgIGlmICh1bml0RGVmaW5pdGlvblByb2R1Y3Rpb24gPT09IG51bGwpIHtcbiAgICAgICAgICB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb24gPSBVbml0RGVmaW5pdGlvblByb2R1Y3Rpb24uZnJvbVByb2R1Y3Rpb25OYW1lcyhmaXJzdFByb2R1Y3Rpb25OYW1lLCBzZWNvbmRQcm9kdWN0aW9uTmFtZSk7XG5cbiAgICAgICAgICB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25zLnVuc2hpZnQodW5pdERlZmluaXRpb25Qcm9kdWN0aW9uKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHVuaXREZWZpbml0aW9uUHJvZHVjdGlvbnNMZW5ndGggPSB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25zLmxlbmd0aDtcbiAgfVxuXG4gIG5vbkN5Y2xpY1Byb2R1Y3Rpb25zRnJvbUZpeGVkQW5kQWRkZWRQcm9kdWN0aW9ucyhmaXhlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25zLCBhZGRlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25zLCBub25DeWNsaWNQcm9kdWN0aW9ucyk7XG59XG5cbmZ1bmN0aW9uIG5vbkN5Y2xpY1Byb2R1Y3Rpb25zRnJvbUZpeGVkQW5kQWRkZWRQcm9kdWN0aW9ucyhmaXhlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25zLCBhZGRlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25zLCBub25DeWNsaWNQcm9kdWN0aW9ucykge1xuICBmaXhlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25zLmZvckVhY2goZnVuY3Rpb24oZml4ZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uKSB7XG4gICAgY29uc3Qgbm9uQ3ljbGljUHJvZHVjdGlvbiA9IGZpeGVkTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbiwgLy8vXG4gICAgICAgICAgbm9uQ3ljbGljUHJvZHVjdGlvbk5hbWUgPSBub25DeWNsaWNQcm9kdWN0aW9uLmdldE5hbWUoKSxcbiAgICAgICAgICBhZGRlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25OYW1lID0gbm9uQ3ljbGljUHJvZHVjdGlvbk5hbWUsIC8vL1xuICAgICAgICAgIGFkZGVkTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbiA9IHBhcnNlclV0aWwuZmluZFByb2R1Y3Rpb24oYWRkZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uTmFtZSwgYWRkZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9ucyk7XG5cbiAgICBpZiAoYWRkZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uICE9PSBudWxsKSB7XG4gICAgICBjb25zdCBhZGRlZE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25EZWZpbml0aW9ucyA9IGFkZGVkTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbi5nZXREZWZpbml0aW9ucygpO1xuXG4gICAgICBub25DeWNsaWNQcm9kdWN0aW9uLmFkZERlZmluaXRpb25zKGFkZGVkTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbkRlZmluaXRpb25zKTtcbiAgICB9XG5cbiAgICBjb25zdCBub25DeWNsaWNQcm9kdWN0aW9uRGVmaW5pdGlvbnNFeGlzdCA9IG5vbkN5Y2xpY1Byb2R1Y3Rpb24uZG9EZWZpbml0aW9uc0V4aXN0KCk7XG5cbiAgICBpZiAobm9uQ3ljbGljUHJvZHVjdGlvbkRlZmluaXRpb25zRXhpc3QpIHtcbiAgICAgIG5vbkN5Y2xpY1Byb2R1Y3Rpb25zLnB1c2gobm9uQ3ljbGljUHJvZHVjdGlvbik7XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uc0Zyb21Db21wb25lbnQoY29tcG9uZW50LCBwcm9kdWN0aW9ucywgbm9uQ3ljbGljUHJvZHVjdGlvbnMpIHtcbiAgY29uc3QgdW5pdERlZmluaXRpb25zUHJvZHVjdGlvbnMgPSB1bml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uc0Zyb21Db21wb25lbnQoY29tcG9uZW50LCBwcm9kdWN0aW9ucyksXG4gICAgICAgIHVuaXREZWZpbml0aW9uUHJvZHVjdGlvbnMgPSB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25zRnJvbVVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25zKHVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb25zKTtcblxuICByZXR1cm4gdW5pdERlZmluaXRpb25Qcm9kdWN0aW9ucztcbn1cblxuZnVuY3Rpb24gdW5pdERlZmluaXRpb25zUHJvZHVjdGlvbnNGcm9tQ29tcG9uZW50KGNvbXBvbmVudCwgcHJvZHVjdGlvbnMpIHtcbiAgY29uc3QgdW5pdERlZmluaXRpb25zUHJvZHVjdGlvbnMgPSBjb21wb25lbnQubWFwVmVydGljZXMoZnVuY3Rpb24odmVydGV4KSB7XG4gICAgY29uc3QgdmVydGV4TmFtZSA9IHZlcnRleC5nZXROYW1lKCksXG4gICAgICAgICAgcHJvZHVjdGlvbk5hbWUgPSB2ZXJ0ZXhOYW1lLCAgLy8vXG4gICAgICAgICAgcHJvZHVjdGlvbiA9IHBhcnNlclV0aWwuZmluZFByb2R1Y3Rpb24ocHJvZHVjdGlvbk5hbWUsIHByb2R1Y3Rpb25zKSxcbiAgICAgICAgICB1bml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uID0gVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbi5mcm9tUHJvZHVjdGlvbihwcm9kdWN0aW9uKTtcblxuICAgIHJldHVybiB1bml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uO1xuICB9KTtcblxuICByZXR1cm4gdW5pdERlZmluaXRpb25zUHJvZHVjdGlvbnM7XG59XG5cbmZ1bmN0aW9uIGZpeGVkTm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbnNGcm9tUHJvZHVjdGlvbnMocHJvZHVjdGlvbnMpIHtcbiAgY29uc3QgZml4ZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9ucyA9IHByb2R1Y3Rpb25zLm1hcChmdW5jdGlvbihwcm9kdWN0aW9uKSB7XG4gICAgY29uc3Qgbm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbiA9IE5vblVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb24uZnJvbVByb2R1Y3Rpb24ocHJvZHVjdGlvbiksXG4gICAgICAgICAgZml4ZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uID0gbm9uVW5pdERlZmluaXRpb25zUHJvZHVjdGlvbjsgLy8vXG5cbiAgICByZXR1cm4gZml4ZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uO1xuICB9KTtcblxuICByZXR1cm4gZml4ZWROb25Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9ucztcbn1cblxuZnVuY3Rpb24gdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uc0Zyb21Vbml0RGVmaW5pdGlvbnNQcm9kdWN0aW9ucyh1bml0RGVmaW5pdGlvbnNQcm9kdWN0aW9ucykge1xuICBjb25zdCB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25zID0gdW5pdERlZmluaXRpb25zUHJvZHVjdGlvbnMucmVkdWNlKGZ1bmN0aW9uKHVuaXREZWZpbml0aW9uUHJvZHVjdGlvbnMsIHVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb24pIHtcbiAgICBjb25zdCB1bml0RGVmaW5pdGlvbnNQcm9kdWN0aW9uTmFtZSA9IHVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb24uZ2V0TmFtZSgpO1xuICAgIFxuICAgIHVuaXREZWZpbml0aW9uc1Byb2R1Y3Rpb24uZm9yRWFjaFVuaXREZWZpbml0aW9uKGZ1bmN0aW9uKHVuaXREZWZpbml0aW9uKSB7XG4gICAgICBjb25zdCBuYW1lID0gdW5pdERlZmluaXRpb25zUHJvZHVjdGlvbk5hbWUsIC8vL1xuICAgICAgICAgICAgdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uID0gVW5pdERlZmluaXRpb25Qcm9kdWN0aW9uLmZyb21OYW1lQW5kVW5pdERlZmluaXRpb24obmFtZSwgdW5pdERlZmluaXRpb24pO1xuXG4gICAgICB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25zLnB1c2godW5pdERlZmluaXRpb25Qcm9kdWN0aW9uKTtcbiAgICB9KTtcblxuICAgIHJldHVybiB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25zO1xuICB9LCBbXSk7XG5cbiAgcmV0dXJuIHVuaXREZWZpbml0aW9uUHJvZHVjdGlvbnM7XG59XG5cbmZ1bmN0aW9uIGZpbmRVbml0RGVmaW5pdGlvblByb2R1Y3Rpb24oZmlyc3RQcm9kdWN0aW9uTmFtZSwgc2Vjb25kUHJvZHVjdGlvbk5hbWUsIHVuaXREZWZpbml0aW9uUHJvZHVjdGlvbnMpIHtcbiAgbGV0IGZvdW5kVW5pdERlZmluaXRpb25Qcm9kdWN0aW9uID0gbnVsbDtcblxuICB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25zLnNvbWUoZnVuY3Rpb24odW5pdERlZmluaXRpb25Qcm9kdWN0aW9uKSB7XG4gICAgY29uc3QgdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uRm91bmQgPSB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb24uaXNGb3VuZEJ5UHJvZHVjdGlvbk5hbWVzKGZpcnN0UHJvZHVjdGlvbk5hbWUsIHNlY29uZFByb2R1Y3Rpb25OYW1lKTtcblxuICAgIGlmICh1bml0RGVmaW5pdGlvblByb2R1Y3Rpb25Gb3VuZCkge1xuICAgICAgZm91bmRVbml0RGVmaW5pdGlvblByb2R1Y3Rpb24gPSB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb247XG5cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfSk7XG5cbiAgY29uc3QgdW5pdERlZmluaXRpb25Qcm9kdWN0aW9uID0gZm91bmRVbml0RGVmaW5pdGlvblByb2R1Y3Rpb247IC8vL1xuXG4gIHJldHVybiB1bml0RGVmaW5pdGlvblByb2R1Y3Rpb247XG59XG4iXX0=